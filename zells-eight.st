Morph subclass: #Scope	instanceVariableNames: 'collapsed expandedSize body toggler target'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!Scope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 14:54'!collapse	body delete.	expandedSize := self extent.	self extent: (self width)@20.	collapsed := true.! !!Scope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 14:53'!createBody	^ Morph new color: Color black! !!Scope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 14:57'!expand			self extent: expandedSize.	collapsed := false.		self addMorph: (body		position: self position + (5@20);		extent: expandedSize - (10@25);		yourself).! !!Scope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:02'!extent: aPoint	toggler position: self position + ((aPoint x-15)@5).	body extent: aPoint - (10@25).	^ super extent: aPoint. ! !!Scope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:07'!initialize	super initialize.		body := self createBody.		toggler := Morph new.	self addMorph: (toggler		color: Color green;		position: 185@5;		extent: 10@10;		on: #mouseUp send: #toggleCollapse to: self;		yourself).		collapsed := false.	expandedSize := 200@100.	self expand.! !!Scope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:35'!pointAt: aZell	target := aZell.! !!Scope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 14:34'!toggleCollapse	collapsed 		ifTrue: [self expand]		ifFalse: [self collapse].! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Scope class	instanceVariableNames: ''!!Scope class methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:35'!pointingAt: aZell	^ self new		pointAt: aZell;		yourself.! !Scope subclass: #TextScope	instanceVariableNames: 'text'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!TextScope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:55'!createBody	| myBody |	myBody := Morph new 		color: Color black; 		yourself.		text := TextMorph new		color: Color white;		on: #keyUp send: #textChanged to: self;		yourself.			myBody addMorph: text.		^ myBody.! !!TextScope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:38'!extent: aPoint	text position: body position + (body extent / 2) - (text extent / 2).	^ super extent: aPoint.! !!TextScope methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:33'!textChanged	target value: text contents.! !Object subclass: #ZDish	instanceVariableNames: 'culture positions events'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 13:42'!events	^ events! !!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 13:42'!initialize	super initialize.	culture := Set new.	positions := Dictionary new.	events := ZEventEmitter new.! !!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 15:42'!move: aZell to: aPoint	positions at: aZell put: aPoint.! !!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:35'!positionOf: aZell	^ positions at: aZell ifAbsent: [^ 0@0]! !!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:40'!put: aZell	culture add: aZell.	^ aZell.! !!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:41'!put: aZell at: aPoint	self move: aZell to: aPoint.	^ self put: aZell.! !!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 15:08'!remove: aZell 	culture remove: aZell ifAbsent: [].! !!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 16:04'!secondsFrom: aSenderZell to: aReceiverZell	^ ((self positionOf: aSenderZell) dist: (self positionOf: aReceiverZell)) / self signalSpeed! !!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 16:04'!signalSpeed	^ 500! !!ZDish methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 15:41'!transmit: aSignal from: aZell	events fire: #transmittingSignal with: aSignal with: aZell.	culture do: [:receiver | [			(Delay forSeconds: (self secondsFrom: aZell to: receiver)) wait.			receiver receive: aSignal.			] fork]! !Morph subclass: #ZDishMorph	instanceVariableNames: 'dish morphs'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!ZDishMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 15:57'!acceptDroppingMorph: aMorph event: evt	super acceptDroppingMorph: aMorph event: evt.	morphs at: aMorph zell put: aMorph.	dish put: aMorph zell at: aMorph center.	dish transmit: aMorph zell asSignal from: aMorph zell.! !!ZDishMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:48'!dish	^ dish! !!ZDishMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 14:57'!initialize	super initialize.	self extent: 400@200.	self color: Color black.	self clipSubmorphs: true.	morphs := Dictionary new.	dish := ZDish new.	dish events on: #transmittingSignal send: #transmittingSignal:From: to: self.! !!ZDishMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 18:46'!removedMorph: aMorph	(aMorph isKindOf: ZellMorph) ifTrue: [		morphs removeKey: aMorph zell.		dish remove: aMorph zell].! !!ZDishMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 15:05'!transmittingSignal: aSignal From: aZell	self addMorph: (ZSignalMorph new		position: (morphs at: aZell) position;		color: (morphs at: aZell) color;		speed: dish signalSpeed;		maxDiameter: self width * 2;		yourself)! !!ZDishMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:44'!wantsDroppedMorph: aMorph event: evt	^ aMorph isKindOf: ZellMorph! !Object subclass: #ZEventEmitter	instanceVariableNames: 'listeners'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!ZEventEmitter methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 13:44'!fire: anEvent	self fire: anEvent for: [:receiver :message | receiver perform: message].! !!ZEventEmitter methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 13:45'!fire: anEvent for: aBlock	listeners at: anEvent ifPresent: [:listeners | 		listeners keysAndValuesDo: [:receiver :messages | 			messages do: [:message | aBlock value: receiver value: message]]]! !!ZEventEmitter methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 13:45'!fire: anEvent with: anArgument	self fire: anEvent for: [:receiver :message | receiver perform: message with: anArgument].! !!ZEventEmitter methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 14:43'!fire: anEvent with: anArgument with: anotherArgument	self fire: anEvent for: [:receiver :message | receiver perform: message with: anArgument with: anotherArgument].! !!ZEventEmitter methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:00'!for: anEvent remove: aReceiver	listeners at: anEvent ifPresent: [:ls | ls removeKey: aReceiver]! !!ZEventEmitter methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:18'!initialize	super initialize.	listeners := Dictionary new.! !!ZEventEmitter methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 10:58'!on: anEvent send: aMessage to: aReceiver	((listeners at: anEvent ifAbsentPut: Dictionary new)		at: aReceiver ifAbsentPut: Set new) add: aMessage! !Morph subclass: #ZSignalMorph	instanceVariableNames: 'maxDiameter speed'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!ZSignalMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 14:56'!drawOn: aCanvas	aCanvas frameOval: self bounds width: 1 color: (self color mixed: 0.8 with: Color black).! !!ZSignalMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 15:04'!initialize	super initialize.	maxDiameter := 1000.	speed := 100.! !!ZSignalMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 14:56'!maxDiameter: aNumber	maxDiameter := aNumber.! !!ZSignalMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 15:04'!speed: aNumber	speed := aNumber.! !!ZSignalMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 16:01'!step	self bounds: (self bounds outsetBy: speed / (1000 / self stepTime)).	(self width > maxDiameter) ifTrue: [self delete].! !!ZSignalMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 16:03'!stepTime	^ 20! !Object subclass: #Zell	instanceVariableNames: 'events'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!Zell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 13:39'!asSignal	^ nil! !!Zell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:01'!drawIconOn: aCanvas in: aRectangle! !!Zell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:02'!events	^ events! !!Zell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 10:54'!initialize	super initialize.	events := ZEventEmitter new.! !!Zell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 18:45'!receive: aSignal	events fire: #signalReceived with: aSignal.! !Zell subclass: #LoggingZell	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!LoggingZell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 18:45'!receive: aSignal	super receive: aSignal.	Transcript show: '### received: '; show: aSignal; cr.! !Zell subclass: #TextZell	instanceVariableNames: 'textValue'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!TextZell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 13:40'!asSignal	^ self value! !!TextZell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:01'!drawIconOn: aCanvas in: aRectangle	aCanvas drawString: self iconString at: aRectangle leftCenter + (10@(-5)) font: nil color: Color white.! !!TextZell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 10:50'!iconString	^ self value isEmpty		ifTrue: [^ #T]		ifFalse: [^ self value]! !!TextZell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 10:50'!initialize	super initialize.	self value: ''.! !!TextZell methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:21'!onValueChanged: aBlock	events on: #valueChanged do: aBlock.! !!TextZell methodsFor: 'as yet unclassified' stamp: 'NM 6/22/2018 15:14'!value	^ textValue.! !!TextZell methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:14'!value: aString	textValue := aString.	events fire: #valueChanged.	events fire: #iconChanged.! !Morph subclass: #ZellMorph	instanceVariableNames: 'zell flash'	classVariableNames: ''	poolDictionaries: ''	category: 'zells-eight'!!ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 18:51'!drawOn: aCanvas	flash ifTrue: [aCanvas fillOval: self bounds color: (self color mixed: 0.3 with: Color black)].	aCanvas frameOval: self bounds width: 2 color: self color.	zell drawIconOn: aCanvas in: self bounds.! !!ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 18:49'!initialize	super initialize.	self extent: 50@50.	self color: (((Color wheel: 12) atRandom) mixed: 0.7 with: Color white).		flash := false.	zell := Zell new.! !!ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 18:50'!onReceived: aSignal	flash := true.	self redrawIcon.	[(Delay forSeconds: 0.1) wait.	flash := false.	self redrawIcon.] fork! !!ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 15:11'!position: aPoint	(self owner isKindOf: ZDishMorph) ifTrue: [self owner dish move: self zell to: aPoint].	^ super position: aPoint.! !!ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:07'!redrawIcon	self invalidRect: self bounds! !!ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 11:45'!zell	^ zell! !!ZellMorph methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 18:47'!zell: aZell	zell events for: #iconChanged remove: self.	zell := aZell.	zell events on: #iconChanged send: #redrawIcon to: self.	zell events on: #signalReceived send: #onReceived: to: self.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!ZellMorph class	instanceVariableNames: ''!!ZellMorph class methodsFor: 'as yet unclassified' stamp: 'NM 6/27/2018 10:35'!for: aZell	^ self new		zell: aZell;		yourself.! !